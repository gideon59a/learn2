C:\Python\Python39\python.exe C:/pythonProjects/socketio/my_socketio/ex_e_celery/call_tasks.py
For sending a task to the a specific task queue enter the queue name. Otherwise press enter
Enter celery task queue name: queue_a
Enter 1 for single task test, or 2 for two tasks test (default=1):3
Connected to redis
Running 3 task(s) on queue queue_a
Triggering task1 at time 7.8695802
Task args: (1, 10)
Task1 was triggered at time 7.9871043
Triggering task2 at time 7.9871384
Task args: (2, 20)
Task2 was triggered at time 7.9891851
Triggering task3 at time 7.9892184
Task args: (3, 30)
Task(s) were triggered. Time is 7.9912722

Note: The below result is a <class 'celery.result.AsyncResult'>. When directly read it provides the task id.
result type is: <class 'celery.result.AsyncResult'>.
When we print this instance it returns the task id: 3d0177b3-2b42-4528-9792-29e1267707fa
as its __repr__ is the task id:  <AsyncResult: 3d0177b3-2b42-4528-9792-29e1267707fa>
  while the task id can be also got from result.id: 3d0177b3-2b42-4528-9792-29e1267707fa
Time is 7.9913364

task_id.status (PENDING is expected as the task is being processed): PENDING

Redis info - Reading task queue:
Reading from redis message queue "unacked" the tasks that are still waiting in the queue:
 {b'2622642b-942f-4b95-8c1c-a7a31ccf30f5': b'[{"body": "W1syLCAyMF0sIHt9LCB7ImNhbGxiYWNrcyI6IG51bGwsICJlcnJiYWNrcyI6IG51bGwsICJjaGFpbiI6IG51bGwsICJjaG9yZCI6IG51bGx9XQ==", "content-encoding": "utf-8", "content-type": "application/json", "headers": {"lang": "py", "task": "celery1.add", "id": "c28d5648-05e4-446e-b514-41b8cabae58f", "shadow": null, "eta": null, "expires": null, "group": null, "group_index": null, "retries": 0, "timelimit": [null, null], "root_id": "c28d5648-05e4-446e-b514-41b8cabae58f", "parent_id": null, "argsrepr": "(2, 20)", "kwargsrepr": "{}", "origin": "gen21200@N-20N3PF231BWQ", "ignore_result": false}, "properties": {"correlation_id": "c28d5648-05e4-446e-b514-41b8cabae58f", "reply_to": "e2cddad7-8a7b-3a2e-8012-13eb2613a286", "delivery_mode": 2, "delivery_info": {"exchange": "", "routing_key": "queue_a"}, "priority": 0, "body_encoding": "base64", "delivery_tag": "2622642b-942f-4b95-8c1c-a7a31ccf30f5"}}, "", "queue_a"]',
  b'96baadc4-26fa-4eea-802c-29b16bb3f22a': b'[{"body": "W1szLCAzMF0sIHt9LCB7ImNhbGxiYWNrcyI6IG51bGwsICJlcnJiYWNrcyI6IG51bGwsICJjaGFpbiI6IG51bGwsICJjaG9yZCI6IG51bGx9XQ==", "content-encoding": "utf-8", "content-type": "application/json", "headers": {"lang": "py", "task": "celery1.add", "id": "ecd81013-e0f1-405f-9f65-a95abbef49a7", "shadow": null, "eta": null, "expires": null, "group": null, "group_index": null, "retries": 0, "timelimit": [null, null], "root_id": "ecd81013-e0f1-405f-9f65-a95abbef49a7", "parent_id": null, "argsrepr": "(3, 30)", "kwargsrepr": "{}", "origin": "gen21200@N-20N3PF231BWQ", "ignore_result": false}, "properties": {"correlation_id": "ecd81013-e0f1-405f-9f65-a95abbef49a7", "reply_to": "e2cddad7-8a7b-3a2e-8012-13eb2613a286", "delivery_mode": 2, "delivery_info": {"exchange": "", "routing_key": "queue_a"}, "priority": 0, "body_encoding": "base64", "delivery_tag": "96baadc4-26fa-4eea-802c-29b16bb3f22a"}}, "", "queue_a"]'}

Celery info - Printing celery inspect info BEFORE waiting for the result: (Note that Reserved tasks are tasks that have been received but are still waiting to be executed)
scheduled tasks: {'worker_a@%N-20N3PF231BWQ': []}
active tasks: {'worker_a@%N-20N3PF231BWQ': [{'id': '3d0177b3-2b42-4528-9792-29e1267707fa', 'name': 'celery1.add', 'args': [1, 10], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': 1673853496.0781903, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': 2074}]}
reserved tasks: {'worker_a@%N-20N3PF231BWQ': [{'id': 'c28d5648-05e4-446e-b514-41b8cabae58f', 'name': 'celery1.add', 'args': [2, 20], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': None, 'acknowledged': False, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': None},
                                              {'id': 'ecd81013-e0f1-405f-9f65-a95abbef49a7', 'name': 'celery1.add', 'args': [3, 30], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': None, 'acknowledged': False, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': None}]}



Redis info - Reading from redis task1 result before it appears in redis:
Redis Task result: <class 'NoneType'> None
Celery: Waiting for the 1st task to finish. Time is 11.4254293
Polling celery result waiting for task to finish, 10 sec timeout
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: SUCCESS
Task result: 11

Redis info - Reading from redis the result after task 1 is done. See task2 is now in the active tasks queue:
Redis Task result: <class 'bytes'> b'{"status": "SUCCESS", "result": 11, "traceback": null, "children": [], "date_done": "2023-01-16T07:18:25.088517", "task_id": "3d0177b3-2b42-4528-9792-29e1267707fa"}'
Reading from redis the task result key: <class 'bytes'>  b'{"status": "SUCCESS", "result": 11, "traceback": null, "children": [], "date_done": "2023-01-16T07:18:25.088517", "task_id": "3d0177b3-2b42-4528-9792-29e1267707fa"}' read at 17.5026316
so it has status: SUCCESS  with result: 11
Celery info - Printing celery inspect info after task 1 is done:
scheduled tasks: {'worker_a@%N-20N3PF231BWQ': []}
active tasks: {'worker_a@%N-20N3PF231BWQ': [{'id': 'c28d5648-05e4-446e-b514-41b8cabae58f', 'name': 'celery1.add', 'args': [2, 20], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': 1673853505.0928094, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': 2074}]}
reserved tasks: {'worker_a@%N-20N3PF231BWQ': [{'id': 'ecd81013-e0f1-405f-9f65-a95abbef49a7', 'name': 'celery1.add', 'args': [3, 30], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': None, 'acknowledged': False, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': None}]}


Task status2: PENDING
Task result2: None
Polling celery result waiting for task to finish, 10 sec timeout
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: SUCCESS
Task result: 22

Redis info: Reading from redis the result after task 2 is done.
Redis Task result: <class 'bytes'> b'{"status": "SUCCESS", "result": 22, "traceback": null, "children": [], "date_done": "2023-01-16T07:18:34.103539", "task_id": "c28d5648-05e4-446e-b514-41b8cabae58f"}'
Reading from redis the task result key: <class 'bytes'>  b'{"status": "SUCCESS", "result": 22, "traceback": null, "children": [], "date_done": "2023-01-16T07:18:34.103539", "task_id": "c28d5648-05e4-446e-b514-41b8cabae58f"}' read at 26.142951
so it has status: SUCCESS  with result: 22

Printing celery inspect info at the END (see no tasks are now in the active tasks queue):
scheduled tasks: {'worker_a@%N-20N3PF231BWQ': []}
active tasks: {'worker_a@%N-20N3PF231BWQ': [{'id': 'ecd81013-e0f1-405f-9f65-a95abbef49a7', 'name': 'celery1.add', 'args': [3, 30], 'kwargs': {}, 'type': 'celery1.add', 'hostname': 'worker_a@%N-20N3PF231BWQ', 'time_start': 1673853514.1102612, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'queue_a', 'priority': 0, 'redelivered': None}, 'worker_pid': 2074}]}
reserved tasks: {'worker_a@%N-20N3PF231BWQ': []}


Task status3: PENDING
Task result3: None
Polling celery result waiting for task to finish, 10 sec timeout
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: PENDING
Task status: SUCCESS
Task result: 33
End.

Process finished with exit code 0
